<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Editor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            padding: 1rem;
        }

        .editor-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            color: #64748b;
            transition: all 0.2s;
        }

        .tab.active {
            background: #1e3a5f;
            color: white;
            border-color: #1e3a5f;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #334155;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .form-group input[type="text"],
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.95rem;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #1e3a5f;
        }

        .language-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .save-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 2rem;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
            transition: all 0.3s;
            z-index: 1000;
        }

        .save-btn:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.5);
        }

        .success-message {
            position: fixed;
            top: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            background: #10b981;
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s;
            z-index: 1001;
        }

        .success-message.show {
            opacity: 1;
            transform: translateY(0);
        }

        h2 {
            color: #1e3a5f;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #e2e8f0;
        }

        @media (max-width: 768px) {
            .language-group {
                grid-template-columns: 1fr;
            }

            .tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
        }
    </style>
</head>
<body>
    <div class="editor-container">
        <div class="tabs">
            <div class="tab active" onclick="switchTab('hero')">Hero</div>
            <div class="tab" onclick="switchTab('about')">About</div>
            <div class="tab" onclick="switchTab('mission')">Mission & Values</div>
            <div class="tab" onclick="switchTab('contact')">Contact</div>
        </div>

        <!-- Hero Tab -->
        <div class="tab-content active" id="hero">
            <h2>Hero Section</h2>
            
            <div class="form-group">
                <label>Badge Text</label>
                <div class="language-group">
                    <div>
                        <input type="text" id="hero-badge-fr" placeholder="French">
                    </div>
                    <div>
                        <input type="text" id="hero-badge-en" placeholder="English">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Title Line 1</label>
                <div class="language-group">
                    <input type="text" id="hero-title1-fr" placeholder="French">
                    <input type="text" id="hero-title1-en" placeholder="English">
                </div>
            </div>

            <div class="form-group">
                <label>Title Line 2</label>
                <div class="language-group">
                    <input type="text" id="hero-title2-fr" placeholder="French">
                    <input type="text" id="hero-title2-en" placeholder="English">
                </div>
            </div>

            <div class="form-group">
                <label>Subtitle</label>
                <div class="language-group">
                    <textarea id="hero-subtitle-fr" placeholder="French"></textarea>
                    <textarea id="hero-subtitle-en" placeholder="English"></textarea>
                </div>
            </div>

            <div class="form-group">
                <label>Button 1 Text</label>
                <div class="language-group">
                    <input type="text" id="hero-btn1-fr" placeholder="French">
                    <input type="text" id="hero-btn1-en" placeholder="English">
                </div>
            </div>

            <div class="form-group">
                <label>Button 2 Text</label>
                <div class="language-group">
                    <input type="text" id="hero-btn2-fr" placeholder="French">
                    <input type="text" id="hero-btn2-en" placeholder="English">
                </div>
            </div>
        </div>

        <!-- About Tab -->
        <div class="tab-content" id="about">
            <h2>About Section</h2>
            
            <div class="form-group">
                <label>Section Label</label>
                <div class="language-group">
                    <input type="text" id="about-label-fr" placeholder="French">
                    <input type="text" id="about-label-en" placeholder="English">
                </div>
            </div>

            <div class="form-group">
                <label>Title</label>
                <div class="language-group">
                    <input type="text" id="about-title-fr" placeholder="French">
                    <input type="text" id="about-title-en" placeholder="English">
                </div>
            </div>

            <div class="form-group">
                <label>Content</label>
                <div class="language-group">
                    <textarea id="about-content-fr" placeholder="French" style="min-height: 150px;"></textarea>
                    <textarea id="about-content-en" placeholder="English" style="min-height: 150px;"></textarea>
                </div>
            </div>
        </div>

        <!-- Mission Tab -->
        <div class="tab-content" id="mission">
            <h2>Mission & Values</h2>
            
            <div class="form-group">
                <label>Mission Title</label>
                <div class="language-group">
                    <input type="text" id="mission-title-fr" placeholder="French">
                    <input type="text" id="mission-title-en" placeholder="English">
                </div>
            </div>

            <div class="form-group">
                <label>Mission Content</label>
                <div class="language-group">
                    <textarea id="mission-content-fr" placeholder="French" style="min-height: 150px;"></textarea>
                    <textarea id="mission-content-en" placeholder="English" style="min-height: 150px;"></textarea>
                </div>
            </div>

            <div class="form-group">
                <label>Values Title</label>
                <div class="language-group">
                    <input type="text" id="values-title-fr" placeholder="French">
                    <input type="text" id="values-title-en" placeholder="English">
                </div>
            </div>
        </div>

        <!-- Contact Tab -->
        <div class="tab-content" id="contact">
            <h2>Contact Information</h2>
            
            <div class="form-group">
                <label>Address</label>
                <textarea id="contact-address" placeholder="Full address"></textarea>
            </div>

            <div class="form-group">
                <label>Email</label>
                <input type="text" id="contact-email" placeholder="email@example.com">
            </div>

            <div class="form-group">
                <label>Phone</label>
                <input type="text" id="contact-phone" placeholder="+212 xxx xxx xxx">
            </div>

            <div class="form-group">
                <label>Fax</label>
                <input type="text" id="contact-fax" placeholder="+212 xxx xxx xxx">
            </div>
        </div>
    </div>

    <button class="save-btn" onclick="saveAllChanges()">ðŸ’¾ Save Changes</button>
    <div class="success-message" id="successMessage">âœ“ Changes saved successfully!</div>

    <script type="module">
        import { doc, getDoc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Get Firebase instances from parent window
        const db = window.parent.firebaseDb;
        const contentDocRef = doc(db, 'website', 'content');

        // Load existing content from Firebase
        async function loadContent() {
            try {
                const docSnap = await getDoc(contentDocRef);
                
                if (docSnap.exists()) {
                    const content = docSnap.data();
                
                // Load Hero
                if (content.hero) {
                    document.getElementById('hero-badge-fr').value = content.hero.badge?.fr || '';
                    document.getElementById('hero-badge-en').value = content.hero.badge?.en || '';
                    document.getElementById('hero-title1-fr').value = content.hero.title1?.fr || '';
                    document.getElementById('hero-title1-en').value = content.hero.title1?.en || '';
                    document.getElementById('hero-title2-fr').value = content.hero.title2?.fr || '';
                    document.getElementById('hero-title2-en').value = content.hero.title2?.en || '';
                    document.getElementById('hero-subtitle-fr').value = content.hero.subtitle?.fr || '';
                    document.getElementById('hero-subtitle-en').value = content.hero.subtitle?.en || '';
                    document.getElementById('hero-btn1-fr').value = content.hero.btn1?.fr || '';
                    document.getElementById('hero-btn1-en').value = content.hero.btn1?.en || '';
                    document.getElementById('hero-btn2-fr').value = content.hero.btn2?.fr || '';
                    document.getElementById('hero-btn2-en').value = content.hero.btn2?.en || '';
                }

                // Load About
                if (content.about) {
                    document.getElementById('about-label-fr').value = content.about.label?.fr || '';
                    document.getElementById('about-label-en').value = content.about.label?.en || '';
                    document.getElementById('about-title-fr').value = content.about.title?.fr || '';
                    document.getElementById('about-title-en').value = content.about.title?.en || '';
                    document.getElementById('about-content-fr').value = content.about.content?.fr || '';
                    document.getElementById('about-content-en').value = content.about.content?.en || '';
                }

                // Load Mission
                if (content.mission) {
                    document.getElementById('mission-title-fr').value = content.mission.title?.fr || '';
                    document.getElementById('mission-title-en').value = content.mission.title?.en || '';
                    document.getElementById('mission-content-fr').value = content.mission.content?.fr || '';
                    document.getElementById('mission-content-en').value = content.mission.content?.en || '';
                }

                // Load Values
                if (content.values) {
                    document.getElementById('values-title-fr').value = content.values.title?.fr || '';
                    document.getElementById('values-title-en').value = content.values.title?.en || '';
                }

                // Load Contact
                if (content.contact) {
                    document.getElementById('contact-address').value = content.contact.address || '';
                    document.getElementById('contact-email').value = content.contact.email || '';
                    document.getElementById('contact-phone').value = content.contact.phone || '';
                    document.getElementById('contact-fax').value = content.contact.fax || '';
                }
            } catch (error) {
                console.error('Error loading content:', error);
                alert('Failed to load content. Please refresh the page.');
            }
        }

        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Show selected tab
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        async function saveAllChanges() {
            const saveBtn = document.querySelector('.save-btn');
            saveBtn.disabled = true;
            saveBtn.textContent = 'ðŸ’¾ Saving...';

            try {
                const content = {};

            // Save Hero
            content.hero = {
                badge: {
                    fr: document.getElementById('hero-badge-fr').value,
                    en: document.getElementById('hero-badge-en').value
                },
                title1: {
                    fr: document.getElementById('hero-title1-fr').value,
                    en: document.getElementById('hero-title1-en').value
                },
                title2: {
                    fr: document.getElementById('hero-title2-fr').value,
                    en: document.getElementById('hero-title2-en').value
                },
                subtitle: {
                    fr: document.getElementById('hero-subtitle-fr').value,
                    en: document.getElementById('hero-subtitle-en').value
                },
                btn1: {
                    fr: document.getElementById('hero-btn1-fr').value,
                    en: document.getElementById('hero-btn1-en').value
                },
                btn2: {
                    fr: document.getElementById('hero-btn2-fr').value,
                    en: document.getElementById('hero-btn2-en').value
                }
            };

            // Save About
            content.about = {
                label: {
                    fr: document.getElementById('about-label-fr').value,
                    en: document.getElementById('about-label-en').value
                },
                title: {
                    fr: document.getElementById('about-title-fr').value,
                    en: document.getElementById('about-title-en').value
                },
                content: {
                    fr: document.getElementById('about-content-fr').value,
                    en: document.getElementById('about-content-en').value
                }
            };

            // Save Mission
            content.mission = {
                title: {
                    fr: document.getElementById('mission-title-fr').value,
                    en: document.getElementById('mission-title-en').value
                },
                content: {
                    fr: document.getElementById('mission-content-fr').value,
                    en: document.getElementById('mission-content-en').value
                }
            };

            // Save Values
            content.values = {
                title: {
                    fr: document.getElementById('values-title-fr').value,
                    en: document.getElementById('values-title-en').value
                }
            };

            // Save Contact
            content.contact = {
                address: document.getElementById('contact-address').value,
                email: document.getElementById('contact-email').value,
                phone: document.getElementById('contact-phone').value,
                fax: document.getElementById('contact-fax').value
            };

            // Save to Firebase
            await setDoc(contentDocRef, content);

            // Also save to localStorage as backup
            localStorage.setItem('taziContent', JSON.stringify(content));

            // Show success message
            const successMsg = document.getElementById('successMessage');
            successMsg.classList.add('show');
            saveBtn.disabled = false;
            saveBtn.textContent = 'ðŸ’¾ Save Changes';
            setTimeout(() => {
                successMsg.classList.remove('show');
            }, 3000);
        } catch (error) {
            console.error('Error saving:', error);
            alert('Failed to save changes. Please try again.');
            saveBtn.disabled = false;
            saveBtn.textContent = 'ðŸ’¾ Save Changes';
        }
        }

        // Load content on page load
        loadContent();
    </script>
</body>
</html>

